## Process this file with automake to produce Makefile.in.

# The following subdirectories have makefiles:
SUBDIRS = vmips.misc-tests vmips.outcheck vmips.regcheck

# We are running tests in this directory.
AUTOMAKE_OPTIONS = dejagnu

# Also need to distribute the following files:
EXTRA_DIST = \
	config/unix.exp \
	lib/vmips-misc.exp \
	lib/vmips-outcheck.exp \
	lib/vmips-regcheck.exp \
	lib/vmips.exp

# Extra things to clean up:
CLEANFILES = vmips.log dbg.log vmips.sum
DISTCLEANFILES = site.exp

# We need our own site.exp rule so that we can pass the current
# endianness (represented by the default value of the 'bigendian' option)
# to the testsuite. 

BIGENDIAN = @BIGENDIAN@

site.exp: Makefile
	@echo 'Making a new site.exp file...'
	@test ! -f site.bak || rm -f site.bak
	@echo '# This file is automatically generated by make,' > $@-t
	@echo '# using values supplied by configure. If you make' >> $@-t
	@echo '# changes here, they will go away. See below.' >> $@-t
	@echo 'set tool "$(DEJATOOL)"' >> $@-t
	@echo 'set srcdir "$(srcdir)"' >> $@-t
	@d=`pwd`; echo "set objdir \"$$d\"" >> $@-t
	@echo 'set host_alias "$(host_alias)"' >> $@-t
	@echo 'set host_triplet "$(host_triplet)"' >> $@-t
	@echo 'set target_alias "$(target_alias)"' >> $@-t
	@echo 'set target_triplet "$(target_triplet)"' >> $@-t
	@echo 'set build_alias "$(build_alias)"' >> $@-t
	@echo 'set build_triplet "$(build_triplet)"' >> $@-t
	@echo 'set endian_option "$(BIGENDIAN)"' >> $@-t
	@echo '# If you make changes above here, they will go away.' >> $@-t
	@echo '# Make them below instead.' >> $@-t
	@test ! -f site.exp || sed '1,/^# Make them below instead\./d' site.exp >> $@-t
	@test ! -f site.exp || mv site.exp site.bak
	@mv $@-t site.exp
